@using Kendo.Mvc.UI
@model MVC_BathCompareSIte.DTO.CategoryDTO
           
<div class="form-horizontal">
    @Html.HiddenFor(model => model.Id)
    <div class="form-group">
        @Html.LabelFor(model => model.Name, new {@class = "col-md-3 control-label"})
        <div class="col-md-4">
            @Html.EditorFor(model => model.Name, new {@class = "form-control"})
        </div>
    </div>
    <div class="form-group">
        @Html.LabelFor(model => model.Description, new {@class = "col-md-3 control-label"})
        <div class="col-md-4">
            @Html.EditorFor(model => model.Description, new {@class = "form-control"})
        </div>
    </div>
    <div class="form-group">
        <input type="hidden" id="category_editor"/>
        @Html.HiddenFor(model => model.ParentCategoryId)
        @Html.HiddenFor(model => model.selIndex)
        <label for="" class="col-md-3 control-label">Parent Category</label>
        <div class="col-md-4">
            <input id="categories" placeholder="Select a category..." />
        </div>
    </div>
</div>

<script type="text/javascript">
    $(document).ready(function() {
        $("#categories").kendoComboBox({
            dataTextField: "Name",
            dataValueField: "Id",
            filter: "contains",
            suggest: true,
        });

        getCategories();

        function getCategories() {
            $.ajax({
                url: "@Url.Action("GetCategories", "Home")",
                type: 'POST',
            contentType: 'application/json',
            success: function(result) {
                var dd = $('#categories').data("kendoComboBox");
                dd.setDataSource(result);

                var pVal = $('#selIndex').val();
                if (pVal > 0) {
                    dd.value(pVal);
                }
            },
            error: function (res) {
                alert('[Categories]fail: '+ res.responseText);
            }
            });
        }

        $(".k-grid-update").on("click", function() {
            var selParent = $("#categories").data("kendoComboBox");
            if ($.isNumeric(selParent.value())) {
                var selValue = selParent.value();
                $("#ParentCategoryId").val(selValue);
                $("#ParentCategoryId").trigger('change');
            }
        });
    });

</script>

